# 历小包后端配置使用说明

## 一、使用小皮(XAMPP)配置MySQL数据库

### 1. 安装小皮(XAMPP)

1. 下载小皮(XAMPP)：访问 [XAMPP官网](https://www.apachefriends.org/zh_cn/index.html) 或 [小皮官网](https://www.xp.cn/) 下载适合您系统的版本
2. 安装小皮(XAMPP)：按照安装向导完成安装

### 2. 启动MySQL服务

1. 打开小皮(XAMPP)控制面板
2. 点击MySQL旁边的「启动」按钮
3. 确保MySQL服务成功启动（状态指示灯变为绿色）

### 3. 创建数据库

1. 在小皮(XAMPP)控制面板中，点击MySQL旁边的「管理」按钮，或访问 http://localhost/phpmyadmin
2. 在phpMyAdmin界面中，点击左侧的「新建」
3. 输入数据库名称：`lxb`（与config.js中配置的数据库名称一致）
4. 选择字符集：`utf8mb4_general_ci`
5. 点击「创建」按钮

### 4. 导入数据库表结构

1. 在phpMyAdmin中，选择刚创建的`lxb`数据库
2. 点击顶部的「导入」选项卡
3. 点击「选择文件」，找到并选择`server/init-db.sql`文件
4. 点击页面底部的「执行」按钮
5. 等待导入完成，确认没有错误信息

## 二、启动后端服务器

### 方法一：使用批处理文件启动（推荐）

1. 双击`server/start-server.bat`文件
2. 等待服务器启动完成
3. 看到「历小包后端服务器已启动，监听端口: 3000」信息表示启动成功

### 方法二：手动启动

1. 打开命令提示符(CMD)或PowerShell
2. 进入项目根目录
3. 执行以下命令安装依赖：
   ```
   npm install
   ```
4. 执行以下命令启动服务器：
   ```
   node server/app.js
   ```

## 三、验证服务器是否正常运行

1. 打开浏览器，访问：http://localhost:3000
2. 如果看到类似以下JSON响应，表示服务器运行正常：
   ```json
   {
     "message": "历小包后端服务器运行正常",
     "version": "1.0.0"
   }
   ```

## 四、查看登录信息

当用户通过微信登录时，登录信息会在以下两个地方记录：

1. **服务器控制台**：所有登录请求都会在服务器控制台中显示详细信息
2. **数据库**：登录信息会被记录到`login_logs`表中，用户信息会被记录到`users`表中

### 查看数据库中的登录记录

1. 在phpMyAdmin中，选择`lxb`数据库
2. 点击左侧的`login_logs`表
3. 点击顶部的「浏览」选项卡查看所有登录记录

### 查看用户信息

1. 在phpMyAdmin中，选择`lxb`数据库
2. 点击左侧的`users`表
3. 点击顶部的「浏览」选项卡查看所有用户信息

## 五、常见问题解决

### 1. 端口冲突

如果3000端口被占用，可以修改`config.js`文件中的`port`值，改为其他未被占用的端口。

### 2. 数据库连接失败

- 确保MySQL服务已启动
- 检查`config.js`中的数据库配置是否正确
- 默认配置为：
  ```js
  database: {
    host: 8080,
    user: 'root',
    password: '123456',
    name: 'lxb'
  }
  ```
- 如果您的MySQL配置不同，请相应修改这些值

### 3. 依赖安装失败

如果依赖安装失败，可以尝试以下命令：
```
npm cache clean --force
npm install
```

## 六、配置前端连接后端

确保前端的`utils/config.js`文件中的`baseUrl`与后端服务器地址一致：

```js
export default {
  // API基础URL
  baseUrl: 'http://localhost:3000',
  // 其他配置...
};
```

如果您修改了后端服务器的端口，请相应地更新这个URL。