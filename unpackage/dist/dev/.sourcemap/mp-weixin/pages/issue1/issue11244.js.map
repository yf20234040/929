{"version":3,"sources":["uni-app:///main.js","webpack:///C:/Users/Administrator/Desktop/lxb/pages/issue1/issue11244.vue?4ea6","webpack:///C:/Users/Administrator/Desktop/lxb/pages/issue1/issue11244.vue?0acb","webpack:///C:/Users/Administrator/Desktop/lxb/pages/issue1/issue11244.vue?97fc","webpack:///C:/Users/Administrator/Desktop/lxb/pages/issue1/issue11244.vue?9afd","uni-app:///pages/issue1/issue11244.vue","webpack:///C:/Users/Administrator/Desktop/lxb/pages/issue1/issue11244.vue?862c","webpack:///C:/Users/Administrator/Desktop/lxb/pages/issue1/issue11244.vue?f500"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","docOnlineUrl","isLoading","showGuide","hasError","errorMsg","onLoad","methods","checkEnvAndPrepareDoc","setTimeout","console","openWithWeChat","url","success","filePath","fileType","showMenu","fail","handleError","retry"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,cAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAmI;AACnI;AAC8D;AACL;AACqC;;;AAG9F;AACiL;AACjL,gBAAgB,0LAAU;AAC1B,EAAE,gFAAM;AACR,EAAE,iGAAM;AACR,EAAE,0GAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,qGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAgqB,CAAgB,qrBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eC6BprB;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;EACA;EAEAC;IACA;IACA;EACA;EAEAC;IACAC;MAAA;MAAA;QAAA;UAAA;YAAA;cAAA;gBACA;kBACA;kBACA;oBACA;oBACAC;sBACA;sBACA;oBACA;kBACA;oBACA;oBACA;kBACA;gBACA;kBACA;kBACA;kBACA;kBACAC;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IAEAC;MAAA;MAAA;QAAA;UAAA;YAAA;cAAA;gBACA;gBACA;gBAEA;kBACA;kBACAhB;oBACAiB;oBACAC;sBACA;wBACA;wBACAlB;0BACAmB;0BACAC;0BAAA;0BACAC;0BAAA;0BACAH;4BACAH;4BACA;0BACA;0BACAO;4BACA;0BACA;wBACA;sBACA;wBACA;sBACA;oBACA;oBACAA;sBACA;oBACA;kBACA;gBACA;kBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IAEAC;MACA;MACA;MACA;MACAR;IACA;IAEAS;MAAA;MACA;MACA;MACAV;QACA;MACA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;ACtHA;AAAA;AAAA;AAAA;AAAk+B,CAAgB,49BAAG,EAAC,C;;;;;;;;;;;ACAt/B;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/issue1/issue11244.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/issue1/issue11244.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./issue11244.vue?vue&type=template&id=0f01dfa7&scoped=true&\"\nvar renderjs\nimport script from \"./issue11244.vue?vue&type=script&lang=js&\"\nexport * from \"./issue11244.vue?vue&type=script&lang=js&\"\nimport style0 from \"./issue11244.vue?vue&type=style&index=0&id=0f01dfa7&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\Hbuilder X\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0f01dfa7\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/issue1/issue11244.vue\"\nexport default component.exports","export * from \"-!D:\\\\Hbuilder X\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\Hbuilder X\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!D:\\\\Hbuilder X\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\Hbuilder X\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\Hbuilder X\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\Hbuilder X\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./issue11244.vue?vue&type=template&id=0f01dfa7&scoped=true&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\Hbuilder X\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\Hbuilder X\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!D:\\\\Hbuilder X\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\Hbuilder X\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\Hbuilder X\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./issue11244.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\Hbuilder X\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\Hbuilder X\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!D:\\\\Hbuilder X\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\Hbuilder X\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\Hbuilder X\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./issue11244.vue?vue&type=script&lang=js&\"","<template>\n  <view class=\"container\">\n    <!-- 加载提示 -->\n    <view class=\"loading\" v-if=\"isLoading && !showGuide\">\n      <view class=\"loading-icon\"></view>\n      <text class=\"loading-text\">正在准备文档...</text>\n    </view>\n    \n    <!-- 引导用户使用微信原生预览 -->\n    <view class=\"guide\" v-if=\"showGuide\">\n      <view class=\"guide-icon\">\n        <icon type=\"info\" size=\"50\" color=\"#007aff\"></icon>\n      </view>\n      <text class=\"guide-title\">文档预览指引</text>\n      <text class=\"guide-desc\">由于微信小程序限制，建议使用微信原生文档预览功能</text>\n      <button class=\"open-btn\" @click=\"openWithWeChat\">打开文档</button>\n    </view>\n    \n    <!-- 错误提示 -->\n    <view class=\"error\" v-if=\"hasError\">\n      <icon type=\"warn\" size=\"40\" color=\"#f00\"></icon>\n      <text class=\"error-text\">文档无法加载</text>\n      <text class=\"error-desc\">{{errorMsg}}</text>\n      <button class=\"retry-btn\" @click=\"retry\">重试</button>\n    </view>\n  </view>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      docOnlineUrl: \"https://llzm-lixiaobao.oss-cn-beijing.aliyuncs.com/%E4%B8%80%E6%9C%9F/%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E4%B8%AD%E5%BF%83/%E8%AF%84%E4%BB%B7%E4%BD%93%E7%B3%BB/%E8%AF%84%E4%BB%B7%E8%A1%A8/%E2%80%9C%E6%B4%9E%E8%A7%81%E5%8E%86%E5%8F%B2%E2%80%9D%E7%A0%94%E5%AD%A6%E9%A1%B9%E7%9B%AE%E8%AF%84%E4%BB%B7%E8%A1%A8%EF%BC%88%E5%AE%B6%E9%95%BF%E7%89%88%EF%BC%89.docx\",\n      isLoading: true,\n      showGuide: false,\n      hasError: false,\n      errorMsg: \"\"\n    };\n  },\n  \n  onLoad() {\n    // 页面加载后检查环境并准备文档\n    this.checkEnvAndPrepareDoc();\n  },\n  \n  methods: {\n    async checkEnvAndPrepareDoc() {\n      try {\n        // 检查是否在微信小程序环境\n        if (typeof wx !== 'undefined') {\n          // 短延迟后显示引导界面（避免频繁切换）\n          setTimeout(() => {\n            this.isLoading = false;\n            this.showGuide = true;\n          }, 1500);\n        } else {\n          this.hasError = true;\n          this.errorMsg = \"请在微信小程序中打开\";\n        }\n      } catch (err) {\n        this.isLoading = false;\n        this.hasError = true;\n        this.errorMsg = \"初始化失败，请重试\";\n        console.error(err);\n      }\n    },\n    \n    async openWithWeChat() {\n      this.isLoading = true;\n      this.showGuide = false;\n      \n      try {\n        // 方法1：使用微信的文件下载+打开文档能力（推荐）\n        wx.downloadFile({\n          url: this.docOnlineUrl,\n          success: (res) => {\n            if (res.statusCode === 200) {\n              // 下载成功后打开文档\n              wx.openDocument({\n                filePath: res.tempFilePath,\n                fileType: 'docx', // 明确指定文件类型\n                showMenu: true,   // 允许用户进行分享等操作\n                success: () => {\n                  console.log('文档打开成功');\n                  this.isLoading = false;\n                },\n                fail: (err) => {\n                  this.handleError('打开文档失败，请重试', err);\n                }\n              });\n            } else {\n              this.handleError('文件下载失败，状态码：' + res.statusCode);\n            }\n          },\n          fail: (err) => {\n            this.handleError('下载文件失败，请检查网络', err);\n          }\n        });\n      } catch (err) {\n        this.handleError('操作失败，请重试', err);\n      }\n    },\n    \n    handleError(msg, err) {\n      this.isLoading = false;\n      this.hasError = true;\n      this.errorMsg = msg;\n      console.error('文档操作错误:', err);\n    },\n    \n    retry() {\n      this.hasError = false;\n      this.isLoading = true;\n      setTimeout(() => {\n        this.checkEnvAndPrepareDoc();\n      }, 500);\n    }\n  }\n};\n</script>\n\n<style scoped>\n.container {\n  width: 100%;\n  height: 100vh;\n  background-color: #f5f5f5;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n}\n\n.loading {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n}\n\n.loading-icon {\n  width: 50rpx;\n  height: 50rpx;\n  border: 5rpx solid #e5e5e5;\n  border-top-color: #007aff;\n  border-radius: 50%;\n  animation: spin 1s linear infinite;\n  margin-bottom: 30rpx;\n}\n\n.loading-text {\n  font-size: 30rpx;\n  color: #666;\n}\n\n.guide {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 60rpx 40rpx;\n  background-color: #fff;\n  border-radius: 16rpx;\n  margin: 0 40rpx;\n  box-shadow: 0 10rpx 30rpx rgba(0, 0, 0, 0.1);\n}\n\n.guide-icon {\n  margin-bottom: 40rpx;\n}\n\n.guide-title {\n  font-size: 36rpx;\n  font-weight: bold;\n  color: #333;\n  margin-bottom: 20rpx;\n}\n\n.guide-desc {\n  font-size: 28rpx;\n  color: #666;\n  text-align: center;\n  line-height: 1.6;\n  margin-bottom: 50rpx;\n  max-width: 500rpx;\n}\n\n.open-btn {\n  width: 300rpx;\n  height: 80rpx;\n  line-height: 80rpx;\n  font-size: 30rpx;\n  background-color: #007aff;\n  color: #fff;\n  border-radius: 40rpx;\n}\n\n.error {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 40rpx;\n  text-align: center;\n}\n\n.error-text {\n  font-size: 32rpx;\n  color: #f00;\n  margin: 30rpx 0 10rpx 0;\n}\n\n.error-desc {\n  font-size: 26rpx;\n  color: #888;\n  margin-bottom: 40rpx;\n  max-width: 500rpx;\n}\n\n.retry-btn {\n  background-color: #007aff;\n  color: white;\n  padding: 0 40rpx;\n}\n\n@keyframes spin {\n  from { transform: rotate(0deg); }\n  to { transform: rotate(360deg); }\n}\n</style>\n","import mod from \"-!D:\\\\Hbuilder X\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!D:\\\\Hbuilder X\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!D:\\\\Hbuilder X\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\Hbuilder X\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!D:\\\\Hbuilder X\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!D:\\\\Hbuilder X\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\Hbuilder X\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./issue11244.vue?vue&type=style&index=0&id=0f01dfa7&scoped=true&lang=css&\"; export default mod; export * from \"-!D:\\\\Hbuilder X\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!D:\\\\Hbuilder X\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!D:\\\\Hbuilder X\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\Hbuilder X\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!D:\\\\Hbuilder X\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!D:\\\\Hbuilder X\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\Hbuilder X\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./issue11244.vue?vue&type=style&index=0&id=0f01dfa7&scoped=true&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1759499183476\n      var cssReload = require(\"D:/Hbuilder X/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}